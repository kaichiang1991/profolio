# 時間線重新設計 - 甘特圖風格

**日期：** 2026-02-17
**狀態：** 已核准

## 概述

將個人經歷頁面的時間線重新設計為甘特圖風格，在時間軸右側增加彩色矩形條來視覺化工作時間跨度，並在矩形條右側顯示詳細資訊卡片。

## 背景問題

目前的時間線設計存在以下問題：
- 兩個工作經歷之間雖然時間上沒有間隔，但因為 lane 系統導致卡片在水平方向上分散，視覺上距離很遠
- 缺乏對工作時間跨度的直觀視覺呈現
- 從時間軸到卡片的長距離虛線連接不夠清晰

## 設計目標

1. **時間視覺化**：透過彩色矩形條直觀顯示每份工作的時間跨度
2. **清晰對應**：矩形條與卡片在同一 lane，視覺關聯明確
3. **減少視覺混亂**：簡化連接線，使用短距離連接
4. **保持功能性**：保留 lane 系統處理時間重疊的能力

## 整體架構

### 佈局結構（從左到右）

```
[年份標記] [時間軸線] [矩形條區域] [卡片區域]
   80px        2px      可變寬度      可變寬度
```

### Lane 系統

- **Lane 寬度**：300px
- **Lane 內部結構**：
  - 矩形條：60px 寬
  - 間隙：10px
  - 卡片：230px 寬

## 詳細設計

### 1. 矩形條（Bar）設計

**尺寸：**
- **寬度**：固定 60px
- **高度**：根據工作時間跨度動態計算
  ```typescript
  const startPos = calculatePosition({ start, end: start }, timeRange)
  const endPos = calculatePosition({ start: end || currentDate, end: end || currentDate }, timeRange)
  const barHeight = ((endPos.top - startPos.top) / 100) * timelineHeight
  ```
- **最小高度**：20px（確保短期工作仍可見）

**定位：**
- **垂直位置（top）**：對齊到工作的 start 時間在時間軸上的位置
- **水平位置（left）**：`lane * 300px`
- **Z-index**：在卡片下層

**顏色系統：**
- 全職（full-time）：`bg-blue-500 opacity-80`
- 兼職（part-time）：`bg-green-500 opacity-80`
- 自由接案（freelance）：`bg-purple-500 opacity-80`
- 合約（contract）：`bg-orange-500 opacity-80`

**樣式：**
- 圓角：`rounded`
- 透明度：80%
- Hover 效果：顯示 tooltip（工作時間跨度）

### 2. 卡片定位

**位置計算：**
- **垂直位置（top）**：對齊到工作的 start 時間（與矩形條相同）
- **水平位置（left）**：`lane * 300 + 60 + 10`（矩形條寬度 + 間隙）

**尺寸：**
- 寬度：230px
- 高度：140px

**樣式：**
- 保持現有的卡片樣式和內容
- 左邊框顏色與矩形條顏色相同

### 3. 連接線設計

**從矩形條到卡片：**
- 起點：矩形條右側中點
- 終點：卡片左側中點
- 長度：10px（固定）
- 樣式：實線，顏色與矩形條相同或使用 `stroke-zinc-400`
- 寬度：2px

**移除：**
- 原有的從時間軸到卡片的長距離虛線
- 時間軸上的圓點標記

### 4. Lane 分配邏輯

**保持現有算法：**
```typescript
// 追蹤每個 lane 的最後一張卡片的底部位置
const laneBottoms: number[] = []

// 找到第一個不會重疊的 lane
let lane = 0
while (lane < laneBottoms.length && laneBottoms[lane] > cardY) {
  lane++
}

// 更新這個 lane 的底部位置
laneBottoms[lane] = cardBottom
```

**矩形條與卡片共用 lane 編號**，確保視覺對應。

## 響應式設計

### 桌面版（≥ 768px）

- Lane 寬度：300px
- 矩形條：60px
- 卡片：230px

### 平板/行動裝置（< 768px）

**方案 A（推薦）**：縮小但保持結構
- Lane 寬度：250px
- 矩形條：50px
- 卡片：190px
- 支援橫向滾動

**方案 B**：簡化為單 lane（備選）
- 所有矩形條和卡片垂直堆疊
- 適合極小螢幕

## 邊界情況處理

### 1. 極短期工作（< 2 個月）
- 矩形條設定 `min-height: 20px`
- 確保視覺可見

### 2. 極長期工作（> 3 年）
- 矩形條自然延伸
- 卡片高度保持固定（不跟隨矩形條）

### 3. 當前進行中的工作（end = null）
- 矩形條延伸到當前日期
- 可選：添加漸變或脈動動畫表示「進行中」狀態

### 4. 空資料狀態
- 保持現有的空狀態處理邏輯

## 互動效果

### Hover 效果

**卡片 hover：**
- 保持 `hover:shadow-md`
- 可選：對應的矩形條同步高亮

**矩形條 hover：**
- 顯示 tooltip：「2016/12 - 2019/05 (2 年 6 個月)」
- 增加 opacity 或添加邊框

### 過渡動畫

**初始載入（可選）：**
- 矩形條從上到下漸進出現
- 卡片稍微延遲後淡入
- 連接線最後繪製

**語言切換：**
- 卡片內容平滑過渡

## 可訪問性

- 矩形條添加 `aria-label` 描述工作和時間跨度
- 確保顏色對比度符合 WCAG AA 標準
- 鍵盤導航支援（tab 順序：年份 → 矩形條 → 卡片）

## 實作考量

### 保持不變的部分

1. `experience.ts` 資料結構
2. `calculatePosition` 和 `getTimeRange` 工具函數
3. `TimelineYearMarkers` 組件
4. Lane 分配算法的核心邏輯

### 需要修改的部分

1. **Experience.tsx**：
   - 添加矩形條的渲染邏輯
   - 修改卡片的水平位置計算
   - 簡化 SVG 連接線（從長距離改為短距離）
   - 調整 lane 寬度常數

2. **樣式調整**：
   - 新增矩形條的 Tailwind 類別
   - 調整響應式斷點

### 實作步驟建議

1. 在現有 `cardsWithPosition` 數據中添加矩形條所需資訊（barHeight, barTop）
2. 在時間軸右側渲染矩形條層
3. 調整卡片的水平位置（增加矩形條寬度 + 間隙）
4. 修改 SVG 連接線（從矩形條到卡片的短線）
5. 添加響應式樣式
6. 測試邊界情況和互動效果

## 設計決策記錄

### 為什麼選擇方案 1（緊湊型軌道系統）？

1. **最佳平衡**：視覺清晰度、空間利用和實作複雜度的最佳平衡
2. **易於改造**：基於現有 lane 系統，只需添加矩形條視覺化
3. **時間視覺化**：矩形條長度對應工作時間跨度
4. **清晰對應**：矩形條與卡片在同一 lane

### 為什麼矩形條寬度是 60px？

- 足夠寬以顯示顏色和視覺重量
- 不會佔用過多水平空間
- 與 230px 卡片寬度形成合理比例（約 1:4）

### 為什麼使用 10px 間隙？

- 足夠的視覺分離，區分時間軸區域與內容區域
- 不會造成過度分散
- 短連接線易於繪製和理解

---

**核心改變總結：**
✅ 增加彩色矩形條視覺化時間跨度
✅ 矩形條與卡片在同一 lane
✅ 使用短連接線替代長距離虛線
✅ 保持 lane 系統處理重疊

**保持不變：**
✅ 資料結構
✅ Lane 分配邏輯
✅ 卡片內容和樣式
✅ 年份標記和時間軸
